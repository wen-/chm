<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>获取本地SESSION两次回调的问题</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.6001.23580">
</HEAD>
<BODY>
<P>获取本地SESSION两次回调的问题</P><PRE style="BACKGROUND-COLOR: #282525; FONT-FAMILY: 'Source Code Pro Semibold'; COLOR: #ffffff; FONT-SIZE: 14pt"><SPAN style="COLOR: #99ffdd; FONT-WEIGHT: bold">var </SPAN><SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">uuid </SPAN>= <SPAN style="COLOR: #99ff99">req</SPAN>.<SPAN style="FONT-WEIGHT: bold">query</SPAN>.<SPAN style="FONT-WEIGHT: bold">uuid</SPAN>;<BR><SPAN style="COLOR: #99ffdd; FONT-WEIGHT: bold">var </SPAN><SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">current </SPAN>= <SPAN style="COLOR: #99ff99">req</SPAN>.<SPAN style="FONT-WEIGHT: bold">query</SPAN>.<SPAN style="FONT-WEIGHT: bold">current</SPAN>;<BR><BR><SPAN style="COLOR: #99ff99">req</SPAN>.<SPAN style="FONT-WEIGHT: bold">sessionStore</SPAN>.<SPAN style="FONT-STYLE: italic; COLOR: #95c995">get</SPAN>(<SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">uuid</SPAN>,<SPAN style="COLOR: #99ffdd; FONT-WEIGHT: bold">function</SPAN>(<SPAN style="COLOR: #99ff99">err</SPAN>,<SPAN style="COLOR: #99ff99">sid</SPAN>){<BR>    <SPAN style="COLOR: #99ffdd; FONT-WEIGHT: bold">if</SPAN>(<SPAN style="COLOR: #99ff99">sid</SPAN>) {<BR>        <SPAN style="COLOR: #99ff99">res</SPAN>.<SPAN style="FONT-STYLE: italic; COLOR: #95c995">render</SPAN>(<SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'forgetpassactivation'</SPAN>,{<BR>            <SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff; FONT-WEIGHT: bold">'email'</SPAN>: <SPAN style="COLOR: #99ff99">sid</SPAN>.<SPAN style="FONT-WEIGHT: bold">u</SPAN>.<SPAN style="FONT-WEIGHT: bold">email</SPAN>,<FONT color=#ff0000>//<SPAN style="COLOR: #99ff99">sid.session</SPAN>.<SPAN style="FONT-WEIGHT: bold">u</SPAN>.<SPAN style="FONT-WEIGHT: bold">email这样写错了会导致两次回调坑死人了</SPAN><BR></FONT>            <SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff; FONT-WEIGHT: bold">'uuid'</SPAN>:<SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">uuid</SPAN>,<BR>            <SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff; FONT-WEIGHT: bold">'current'</SPAN>:<SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">current<BR></SPAN><SPAN style="COLOR: #99ff99; FONT-WEIGHT: bold">        </SPAN>});<BR>    }<SPAN style="COLOR: #99ffdd; FONT-WEIGHT: bold">else</SPAN>{<BR>        <SPAN style="COLOR: #99ff99">req</SPAN>.<SPAN style="FONT-WEIGHT: bold">flash</SPAN>(<SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'err'</SPAN>,<SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'</SPAN><SPAN style="BACKGROUND-COLOR: #333333; FONT-FAMILY: '宋体'; COLOR: #ccffff">链接已失效！</SPAN><SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'</SPAN>);<BR>        <SPAN style="COLOR: #99ff99">res</SPAN>.<SPAN style="FONT-STYLE: italic; COLOR: #95c995">render</SPAN>(<SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'forgetpassactivation'</SPAN>,{<BR>            <SPAN style="FONT-WEIGHT: bold">err</SPAN>: <SPAN style="COLOR: #99ff99">req</SPAN>.<SPAN style="FONT-WEIGHT: bold">flash</SPAN>(<SPAN style="BACKGROUND-COLOR: #333333; COLOR: #ccffff">'err'</SPAN>).<SPAN style="FONT-STYLE: italic; COLOR: #95c995">toString</SPAN>()<BR>        });<BR>    }<BR>});</PRE></BODY></HTML>