<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>xml文件验证</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 10.00.9200.16521"></HEAD>
<BODY>
<P>xml文件验证</P>
<P><TEXTAREA id=xml_txt style="HEIGHT: 216px; WIDTH: 762px" rows=1 widht="500" height="200"></TEXTAREA></P>
<P><BUTTON onclick="validateXML('xml_txt')" style="HEIGHT: 32px; WIDTH: 108px" 
height="30" width="80">验证</BUTTON> 
<P>&nbsp;</P>
<SCRIPT type=text/javascript>
function validateXML(txt)
{
// code for IE
if (window.ActiveXObject)
{
var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
xmlDoc.async="false";
xmlDoc.loadXML(document.all(txt).value);
if(xmlDoc.parseError.errorCode!=0)
{
txt="错误代码: " + xmlDoc.parseError.errorCode + "\n";
txt=txt+"出错原因: " + xmlDoc.parseError.reason;
txt=txt+"出错行号: " + xmlDoc.parseError.line;
alert(txt);
}
else
{
alert("没有发现错误 !");
}
}
// code for Mozilla, Firefox, Opera, etc.
else if (document.implementation.createDocument)
{
var parser=new DOMParser();
var text=document.getElementById(txt).value;
var xmlDoc=parser.parseFromString(text,"text/xml");
if (xmlDoc.documentElement.nodeName=="parsererror")
{
alert(xmlDoc.documentElement.childNodes[0].nodeValue);
}
else
{
alert("没有发现错误 !");
}
}
else
{
alert('浏览器无法处理XML验证');
}
}
</SCRIPT>
</BODY></HTML>